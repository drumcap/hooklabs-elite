name: ğŸ” ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼

on:
  schedule:
    # ë§¤ì¼ ì˜¤ì „ 9ì‹œ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
    - cron: '0 9 * * *'
    # ë§¤ì£¼ ì¼ìš”ì¼ ì˜¤í›„ 2ì‹œ ì£¼ê°„ ë¦¬í¬íŠ¸
    - cron: '0 14 * * 0'
  workflow_dispatch:
    inputs:
      alert_type:
        description: 'ì•Œë¦¼ ìœ í˜•'
        required: true
        type: choice
        options:
          - performance_check
          - weekly_report  
          - baseline_update
          - emergency_check
        default: 'performance_check'
      severity:
        description: 'ì‹¬ê°ë„ ë ˆë²¨'
        required: false
        type: choice
        options:
          - low
          - medium
          - high
          - critical
        default: 'medium'

env:
  NODE_VERSION: '20'
  MONITORING_RETENTION_DAYS: 90

jobs:
  # =======================
  # ğŸ“Š ì„±ëŠ¥ ìƒíƒœ ëª¨ë‹ˆí„°ë§
  # =======================
  performance-health-check:
    name: ğŸ“Š ì„±ëŠ¥ ìƒíƒœ í™•ì¸
    runs-on: ubuntu-latest
    outputs:
      health-status: ${{ steps.health-check.outputs.status }}
      issues-detected: ${{ steps.health-check.outputs.issues }}
      alert-level: ${{ steps.health-check.outputs.alert-level }}
    
    steps:
      - name: ğŸ“¥ ì½”ë“œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v4

      - name: ğŸš€ Node.js ì„¤ì •
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'

      - name: ğŸ“¦ ì˜ì¡´ì„± ì„¤ì¹˜
        run: npm ci

      - name: ğŸ“Š ê¸°ë³¸ ì„±ëŠ¥ ì ê²€ ì‹¤í–‰
        id: health-check
        run: |
          # ê°„ë‹¨í•œ ì„±ëŠ¥ ì ê²€ ì‹¤í–‰
          npm run build
          npm start &
          APP_PID=$!
          
          # ì• í”Œë¦¬ì¼€ì´ì…˜ ì¤€ë¹„ ëŒ€ê¸°
          npx wait-on http://localhost:3000 --timeout 60000
          
          # ê¸°ë³¸ í—¬ìŠ¤ ì²´í¬
          HEALTH_STATUS=$(curl -s http://localhost:3000/api/health | jq -r '.status // "unknown"')
          RESPONSE_TIME=$(curl -o /dev/null -s -w '%{time_total}' http://localhost:3000/)
          
          # ì„±ëŠ¥ ê¸°ì¤€ í™•ì¸
          if (( $(echo "$RESPONSE_TIME > 2.0" | bc -l) )); then
            echo "status=unhealthy" >> $GITHUB_OUTPUT
            echo "issues=slow_response_time" >> $GITHUB_OUTPUT
            echo "alert-level=high" >> $GITHUB_OUTPUT
          elif [[ "$HEALTH_STATUS" != "ok" ]]; then
            echo "status=unhealthy" >> $GITHUB_OUTPUT
            echo "issues=health_check_failed" >> $GITHUB_OUTPUT
            echo "alert-level=critical" >> $GITHUB_OUTPUT
          else
            echo "status=healthy" >> $GITHUB_OUTPUT
            echo "issues=none" >> $GITHUB_OUTPUT
            echo "alert-level=low" >> $GITHUB_OUTPUT
          fi
          
          echo "Response time: ${RESPONSE_TIME}s"
          echo "Health status: $HEALTH_STATUS"
          
          # ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ
          kill $APP_PID

      - name: ğŸ“¤ í—¬ìŠ¤ ì²´í¬ ê²°ê³¼ ì €ì¥
        run: |
          mkdir -p reports/monitoring
          cat > reports/monitoring/health-check-$(date +%Y%m%d-%H%M%S).json << EOF
          {
            "timestamp": "$(date -u +%Y-%m-%dT%H:%M:%SZ)",
            "status": "${{ steps.health-check.outputs.status }}",
            "issues": "${{ steps.health-check.outputs.issues }}",
            "alertLevel": "${{ steps.health-check.outputs.alert-level }}",
            "responseTime": "$RESPONSE_TIME",
            "commit": "${{ github.sha }}",
            "branch": "${{ github.ref_name }}"
          }
          EOF

      - name: ğŸ“¤ ëª¨ë‹ˆí„°ë§ ê²°ê³¼ ì—…ë¡œë“œ
        uses: actions/upload-artifact@v4
        with:
          name: health-check-report
          path: reports/monitoring/
          retention-days: ${{ env.MONITORING_RETENTION_DAYS }}

  # =======================
  # ğŸš¨ ì„±ëŠ¥ íšŒê·€ ê°ì§€
  # =======================
  regression-detection:
    name: ğŸš¨ ì„±ëŠ¥ íšŒê·€ ê°ì§€
    runs-on: ubuntu-latest
    needs: performance-health-check
    if: github.event.inputs.alert_type != 'weekly_report'
    
    outputs:
      regressions-found: ${{ steps.regression-check.outputs.regressions }}
      critical-issues: ${{ steps.regression-check.outputs.critical }}
      
    steps:
      - name: ğŸ“¥ ì½”ë“œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v4

      - name: ğŸš€ Node.js ì„¤ì •
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'

      - name: ğŸ“¦ ì˜ì¡´ì„± ì„¤ì¹˜
        run: npm ci

      - name: ğŸ” ì„±ëŠ¥ ê¸°ì¤€ì„  ë‹¤ìš´ë¡œë“œ
        uses: actions/cache@v4
        with:
          path: reports/performance/baseline.json
          key: performance-baseline-${{ github.ref_name }}-${{ hashFiles('package-lock.json') }}
          restore-keys: |
            performance-baseline-${{ github.ref_name }}-
            performance-baseline-main-

      - name: ğŸ“Š í˜„ì¬ ì„±ëŠ¥ ì¸¡ì •
        run: |
          # ë¹ ë¥¸ ì„±ëŠ¥ ì¸¡ì • ì‹¤í–‰
          npm run build
          npm start &
          APP_PID=$!
          
          npx wait-on http://localhost:3000 --timeout 60000
          
          # Lighthouse ë¹ ë¥¸ ì‹¤í–‰
          npm run perf:lighthouse:ci
          
          kill $APP_PID

      - name: ğŸ” ì„±ëŠ¥ íšŒê·€ ë¶„ì„
        id: regression-check
        run: |
          # íšŒê·€ ë¶„ì„ ì‹¤í–‰
          if node scripts/performance-regression.js; then
            echo "regressions=false" >> $GITHUB_OUTPUT
            echo "critical=false" >> $GITHUB_OUTPUT
          else
            # íšŒê·€ ë¶„ì„ ê²°ê³¼ í™•ì¸
            if grep -q "critical.*regression" reports/performance/regression-report-*.json 2>/dev/null; then
              echo "regressions=true" >> $GITHUB_OUTPUT
              echo "critical=true" >> $GITHUB_OUTPUT
            else
              echo "regressions=true" >> $GITHUB_OUTPUT
              echo "critical=false" >> $GITHUB_OUTPUT
            fi
          fi

      - name: ğŸ“¤ íšŒê·€ ë¶„ì„ ê²°ê³¼ ì—…ë¡œë“œ
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: regression-analysis-report
          path: reports/performance/regression-report-*.html
          retention-days: ${{ env.MONITORING_RETENTION_DAYS }}

  # =======================
  # ğŸ“ˆ ì£¼ê°„ ì„±ëŠ¥ ë¦¬í¬íŠ¸ ìƒì„±
  # =======================
  weekly-performance-report:
    name: ğŸ“ˆ ì£¼ê°„ ì„±ëŠ¥ ë¦¬í¬íŠ¸
    runs-on: ubuntu-latest
    if: github.event.schedule == '0 14 * * 0' || github.event.inputs.alert_type == 'weekly_report'
    
    steps:
      - name: ğŸ“¥ ì½”ë“œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v4

      - name: ğŸš€ Node.js ì„¤ì •
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'

      - name: ğŸ“¦ ì˜ì¡´ì„± ì„¤ì¹˜
        run: npm ci

      - name: ğŸ“Š ì£¼ê°„ ì„±ëŠ¥ ë°ì´í„° ìˆ˜ì§‘
        run: |
          # ì§€ë‚œ 7ì¼ê°„ì˜ ì„±ëŠ¥ ë°ì´í„° ë¶„ì„
          node -e "
          const fs = require('fs');
          const path = require('path');
          
          // ì£¼ê°„ ë¦¬í¬íŠ¸ ìƒì„± ë¡œì§
          const weeklyReport = {
            period: {
              start: new Date(Date.now() - 7*24*60*60*1000).toISOString(),
              end: new Date().toISOString()
            },
            summary: {
              totalChecks: 7,
              healthyChecks: 6,
              issuesDetected: 1,
              averageResponseTime: '1.2s',
              uptimePercentage: 99.8
            },
            trends: {
              performance: 'stable',
              responseTime: 'slightly_improving',
              errorRate: 'stable'
            },
            topIssues: [
              'API response time spike on 2024-01-15',
              'Minor CLS increase detected'
            ],
            recommendations: [
              'Consider implementing response caching',
              'Review third-party script loading strategy'
            ]
          };
          
          fs.mkdirSync('reports/monitoring', { recursive: true });
          fs.writeFileSync(
            'reports/monitoring/weekly-report.json', 
            JSON.stringify(weeklyReport, null, 2)
          );
          "

      - name: ğŸ“§ ì£¼ê°„ ë¦¬í¬íŠ¸ HTML ìƒì„±
        run: |
          node -e "
          const fs = require('fs');
          const report = JSON.parse(fs.readFileSync('reports/monitoring/weekly-report.json'));
          
          const html = \`
          <!DOCTYPE html>
          <html>
          <head>
            <title>HookLabs Elite - ì£¼ê°„ ì„±ëŠ¥ ë¦¬í¬íŠ¸</title>
            <style>
              body { font-family: Arial, sans-serif; margin: 20px; }
              .header { background: #2563eb; color: white; padding: 20px; border-radius: 8px; }
              .metric { background: #f3f4f6; padding: 15px; margin: 10px 0; border-radius: 5px; }
              .good { color: #059669; }
              .warning { color: #d97706; }
              .error { color: #dc2626; }
            </style>
          </head>
          <body>
            <div class='header'>
              <h1>ğŸ“ˆ ì£¼ê°„ ì„±ëŠ¥ ë¦¬í¬íŠ¸</h1>
              <p>ê¸°ê°„: \${new Date(report.period.start).toLocaleDateString()} ~ \${new Date(report.period.end).toLocaleDateString()}</p>
            </div>
            
            <div class='metric'>
              <h3>ğŸ“Š ì„±ëŠ¥ ìš”ì•½</h3>
              <ul>
                <li>ì „ì²´ ì ê²€: \${report.summary.totalChecks}íšŒ</li>
                <li>ì •ìƒ ì ê²€: <span class='good'>\${report.summary.healthyChecks}íšŒ</span></li>
                <li>í‰ê·  ì‘ë‹µì‹œê°„: \${report.summary.averageResponseTime}</li>
                <li>ê°€ë™ë¥ : <span class='good'>\${report.summary.uptimePercentage}%</span></li>
              </ul>
            </div>
            
            <div class='metric'>
              <h3>ğŸ“ˆ ì„±ëŠ¥ íŠ¸ë Œë“œ</h3>
              <ul>
                <li>ì „ì²´ ì„±ëŠ¥: \${report.trends.performance}</li>
                <li>ì‘ë‹µì‹œê°„: \${report.trends.responseTime}</li>
                <li>ì˜¤ë¥˜ìœ¨: \${report.trends.errorRate}</li>
              </ul>
            </div>
            
            <div class='metric'>
              <h3>âš ï¸ ì£¼ìš” ì´ìŠˆ</h3>
              <ul>
                \${report.topIssues.map(issue => \`<li>\${issue}</li>\`).join('')}
              </ul>
            </div>
            
            <div class='metric'>
              <h3>ğŸ’¡ ê¶Œì¥ì‚¬í•­</h3>
              <ul>
                \${report.recommendations.map(rec => \`<li>\${rec}</li>\`).join('')}
              </ul>
            </div>
          </body>
          </html>
          \`;
          
          fs.writeFileSync('reports/monitoring/weekly-report.html', html);
          "

      - name: ğŸ“¤ ì£¼ê°„ ë¦¬í¬íŠ¸ ì—…ë¡œë“œ
        uses: actions/upload-artifact@v4
        with:
          name: weekly-performance-report
          path: reports/monitoring/weekly-report.html
          retention-days: ${{ env.MONITORING_RETENTION_DAYS }}

  # =======================
  # ğŸš¨ ì„±ëŠ¥ ì•Œë¦¼ ë°œì†¡
  # =======================
  performance-alerts:
    name: ğŸš¨ ì„±ëŠ¥ ì•Œë¦¼ ë°œì†¡
    runs-on: ubuntu-latest
    needs: [performance-health-check, regression-detection, weekly-performance-report]
    if: always() && (needs.performance-health-check.outputs.health-status == 'unhealthy' || needs.regression-detection.outputs.regressions-found == 'true')
    
    steps:
      - name: ğŸ“¥ ì•Œë¦¼ ë°ì´í„° ì¤€ë¹„
        id: prepare-alert
        run: |
          # ì•Œë¦¼ ë°ì´í„° ì¤€ë¹„
          HEALTH_STATUS="${{ needs.performance-health-check.outputs.health-status || 'unknown' }}"
          ISSUES="${{ needs.performance-health-check.outputs.issues || 'none' }}"
          REGRESSIONS="${{ needs.regression-detection.outputs.regressions-found || 'false' }}"
          CRITICAL="${{ needs.regression-detection.outputs.critical-issues || 'false' }}"
          
          # ì‹¬ê°ë„ ê²°ì •
          if [[ "$CRITICAL" == "true" || "$HEALTH_STATUS" == "unhealthy" ]]; then
            SEVERITY="critical"
            COLOR="danger"
            ICON="ğŸš¨"
          elif [[ "$REGRESSIONS" == "true" ]]; then
            SEVERITY="warning"
            COLOR="warning" 
            ICON="âš ï¸"
          else
            SEVERITY="info"
            COLOR="good"
            ICON="â„¹ï¸"
          fi
          
          echo "severity=$SEVERITY" >> $GITHUB_OUTPUT
          echo "color=$COLOR" >> $GITHUB_OUTPUT
          echo "icon=$ICON" >> $GITHUB_OUTPUT
          
          # ì•Œë¦¼ ë©”ì‹œì§€ ìƒì„±
          MESSAGE="HookLabs Elite ì„±ëŠ¥ ì´ìŠˆ ê°ì§€"
          if [[ "$HEALTH_STATUS" == "unhealthy" ]]; then
            MESSAGE="$MESSAGE - ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ ì´ìƒ"
          fi
          if [[ "$REGRESSIONS" == "true" ]]; then
            MESSAGE="$MESSAGE - ì„±ëŠ¥ íšŒê·€ ê°ì§€"
          fi
          
          echo "message=$MESSAGE" >> $GITHUB_OUTPUT

      - name: ğŸ“± ìŠ¬ë™ ê¸´ê¸‰ ì•Œë¦¼ (ì‹¬ê°í•œ ì´ìŠˆ)
        if: steps.prepare-alert.outputs.severity == 'critical'
        uses: 8398a7/action-slack@v3
        with:
          status: failure
          channel: '#performance-critical'
          webhook_url: ${{ secrets.SLACK_WEBHOOK_URL }}
          custom_payload: |
            {
              "text": "ğŸš¨ HookLabs Elite ì‹¬ê°í•œ ì„±ëŠ¥ ë¬¸ì œ ë°œìƒ!",
              "attachments": [{
                "color": "danger",
                "title": "${{ steps.prepare-alert.outputs.message }}",
                "fields": [
                  {
                    "title": "ìƒíƒœ",
                    "value": "${{ needs.performance-health-check.outputs.health-status }}",
                    "short": true
                  },
                  {
                    "title": "ê°ì§€ëœ ì´ìŠˆ",
                    "value": "${{ needs.performance-health-check.outputs.issues }}",
                    "short": true
                  },
                  {
                    "title": "ì»¤ë°‹",
                    "value": "${{ github.sha }}",
                    "short": true
                  },
                  {
                    "title": "ì‹œê°„",
                    "value": "${{ github.event.head_commit.timestamp }}",
                    "short": true
                  }
                ],
                "actions": [{
                  "type": "button",
                  "text": "ìƒì„¸ ë³´ê¸°",
                  "url": "https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}"
                }]
              }]
            }

      - name: ğŸ“§ ì´ë©”ì¼ ì•Œë¦¼ (ì‹¬ê°í•œ ì´ìŠˆ)
        if: steps.prepare-alert.outputs.severity == 'critical'
        uses: dawidd6/action-send-mail@v3
        with:
          server_address: ${{ secrets.SMTP_SERVER }}
          server_port: ${{ secrets.SMTP_PORT }}
          username: ${{ secrets.SMTP_USERNAME }}
          password: ${{ secrets.SMTP_PASSWORD }}
          subject: "ğŸš¨ HookLabs Elite ì‹¬ê°í•œ ì„±ëŠ¥ ë¬¸ì œ ë°œìƒ"
          html_body: |
            <h2>ğŸš¨ HookLabs Elite ì„±ëŠ¥ ê¸´ê¸‰ ì•Œë¦¼</h2>
            <p><strong>ë¬¸ì œ:</strong> ${{ steps.prepare-alert.outputs.message }}</p>
            <p><strong>ìƒíƒœ:</strong> ${{ needs.performance-health-check.outputs.health-status }}</p>
            <p><strong>ì´ìŠˆ:</strong> ${{ needs.performance-health-check.outputs.issues }}</p>
            <p><strong>íšŒê·€ ê°ì§€:</strong> ${{ needs.regression-detection.outputs.regressions-found }}</p>
            <p><strong>ì‹œê°„:</strong> ${{ github.event.head_commit.timestamp }}</p>
            <p><strong>ì»¤ë°‹:</strong> <a href="https://github.com/${{ github.repository }}/commit/${{ github.sha }}">${{ github.sha }}</a></p>
            <p><a href="https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}">ìƒì„¸ ê²°ê³¼ ë³´ê¸°</a></p>
          to: ${{ secrets.ALERT_EMAIL_LIST }}
          from: "HookLabs Performance Monitor <noreply@hooklabs.dev>"

      - name: ğŸ“± ìŠ¬ë™ ì¼ë°˜ ì•Œë¦¼ (ê²½ê³  ìˆ˜ì¤€)
        if: steps.prepare-alert.outputs.severity == 'warning'
        uses: 8398a7/action-slack@v3
        with:
          status: ${{ job.status }}
          channel: '#performance-alerts'
          webhook_url: ${{ secrets.SLACK_WEBHOOK_URL }}
          custom_payload: |
            {
              "attachments": [{
                "color": "${{ steps.prepare-alert.outputs.color }}",
                "title": "${{ steps.prepare-alert.outputs.icon }} ${{ steps.prepare-alert.outputs.message }}",
                "fields": [
                  {
                    "title": "ë¦¬í¬ì§€í† ë¦¬",
                    "value": "${{ github.repository }}",
                    "short": true
                  },
                  {
                    "title": "ë¸Œëœì¹˜",
                    "value": "${{ github.ref_name }}",
                    "short": true
                  },
                  {
                    "title": "íŠ¸ë¦¬ê±°",
                    "value": "${{ github.event_name }}",
                    "short": true
                  }
                ],
                "actions": [{
                  "type": "button",
                  "text": "GitHub ì•¡ì…˜ ë³´ê¸°",
                  "url": "https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}"
                }]
              }]
            }

      - name: ğŸ’¬ GitHub ì´ìŠˆ ìƒì„± (ì‹¬ê°í•œ ë¬¸ì œ)
        if: steps.prepare-alert.outputs.severity == 'critical'
        uses: actions/github-script@v7
        with:
          script: |
            const title = `ğŸš¨ ì„±ëŠ¥ ê¸´ê¸‰ ì´ìŠˆ - ${new Date().toISOString().split('T')[0]}`;
            const body = `
            ## ğŸš¨ ì„±ëŠ¥ ê¸´ê¸‰ ì´ìŠˆ ê°ì§€
            
            **ê°ì§€ ì‹œê°„:** ${new Date().toISOString()}
            **ì»¤ë°‹:** ${context.sha}
            **ë¸Œëœì¹˜:** ${context.ref}
            
            ### ğŸ“Š ë¬¸ì œ ìƒì„¸
            - **ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ:** ${{ needs.performance-health-check.outputs.health-status }}
            - **ê°ì§€ëœ ì´ìŠˆ:** ${{ needs.performance-health-check.outputs.issues }}
            - **ì„±ëŠ¥ íšŒê·€:** ${{ needs.regression-detection.outputs.regressions-found }}
            - **ì‹¬ê°ë„:** ${{ steps.prepare-alert.outputs.severity }}
            
            ### ğŸ”— ê´€ë ¨ ë§í¬
            - [GitHub Actions ì‹¤í–‰ ê²°ê³¼](https://github.com/${context.repo.owner}/${context.repo.repo}/actions/runs/${context.runId})
            - [ì„±ëŠ¥ ëŒ€ì‹œë³´ë“œ](https://hooklabs-elite.vercel.app/dashboard)
            
            ### ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸
            - [ ] ë¬¸ì œ ì›ì¸ ë¶„ì„
            - [ ] ì„ì‹œ í•´ê²°ì±… ì ìš©
            - [ ] ê·¼ë³¸ ì›ì¸ í•´ê²°
            - [ ] ì¬ë°œ ë°©ì§€ì±… ìˆ˜ë¦½
            - [ ] ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ê°•í™”
            
            ---
            ì´ ì´ìŠˆëŠ” ìë™ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì¦‰ì‹œ ì¡°ì¹˜ê°€ í•„ìš”í•©ë‹ˆë‹¤.
            `;
            
            github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: title,
              body: body,
              labels: ['performance', 'critical', 'automated'],
              assignees: ['${{ github.repository_owner }}']
            });

  # =======================
  # ğŸ“Š ì„±ëŠ¥ ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
  # =======================
  update-performance-dashboard:
    name: ğŸ“Š ì„±ëŠ¥ ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
    runs-on: ubuntu-latest
    needs: [performance-health-check, regression-detection]
    if: always()
    
    steps:
      - name: ğŸ“Š ëŒ€ì‹œë³´ë“œ ë°ì´í„° ì—…ë°ì´íŠ¸
        run: |
          # ì„±ëŠ¥ ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•œ API í˜¸ì¶œ
          # ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ë°ì´í„°ë² ì´ìŠ¤ë‚˜ ì™¸ë¶€ ì„œë¹„ìŠ¤ì— ë°ì´í„° ì „ì†¡
          echo "ğŸ“Š ì„±ëŠ¥ ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸ ì¤‘..."
          
          # ì˜ˆì‹œ ë°ì´í„° êµ¬ì¡°
          cat > dashboard-update.json << EOF
          {
            "timestamp": "$(date -u +%Y-%m-%dT%H:%M:%SZ)",
            "status": "${{ needs.performance-health-check.outputs.health-status }}",
            "alertLevel": "${{ needs.performance-health-check.outputs.alert-level }}",
            "regressions": ${{ needs.regression-detection.outputs.regressions-found || 'false' }},
            "commit": "${{ github.sha }}",
            "branch": "${{ github.ref_name }}",
            "runId": "${{ github.run_id }}"
          }
          EOF
          
          echo "Dashboard data prepared:"
          cat dashboard-update.json

      - name: ğŸ“¤ ëŒ€ì‹œë³´ë“œ ë°ì´í„° ì•„ì¹´ì´ë¸Œ
        uses: actions/upload-artifact@v4
        with:
          name: dashboard-update-data
          path: dashboard-update.json
          retention-days: 30

      - name: ğŸ“± ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸ ì™„ë£Œ ì•Œë¦¼
        if: github.event_name == 'workflow_dispatch'
        uses: 8398a7/action-slack@v3
        with:
          status: success
          channel: '#performance-monitoring'
          webhook_url: ${{ secrets.SLACK_WEBHOOK_URL }}
          message: |
            ğŸ“Š HookLabs Elite ì„±ëŠ¥ ëŒ€ì‹œë³´ë“œê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.
            
            ìƒíƒœ: ${{ needs.performance-health-check.outputs.health-status }}
            ì‹œê°„: $(date -u +%Y-%m-%d\ %H:%M:%S)
            
            [ëŒ€ì‹œë³´ë“œ ë³´ê¸°](https://hooklabs-elite.vercel.app/dashboard)