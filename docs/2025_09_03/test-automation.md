# Ïø†Ìè∞ Í¥ÄÎ¶¨ ÏãúÏä§ÌÖú ÌÖåÏä§Ìä∏ ÏûêÎèôÌôî Í∞ÄÏù¥Îìú

## Í∞úÏöî

Ïù¥ Î¨∏ÏÑúÎäî Ïø†Ìè∞ Í¥ÄÎ¶¨ ÏãúÏä§ÌÖúÏùò ÌÖåÏä§Ìä∏ ÏûêÎèôÌôî Íµ¨ÌòÑ Î∞è CI/CD ÌååÏù¥ÌîÑÎùºÏù∏ ÌÜµÌï©Ïóê ÎåÄÌïú Ï¢ÖÌï©Ï†ÅÏù∏ Í∞ÄÏù¥ÎìúÏûÖÎãàÎã§. ÏûêÎèôÌôîÎêú ÌÖåÏä§Ìä∏Î•º ÌÜµÌï¥ ÏΩîÎìú ÌíàÏßàÏùÑ Î≥¥Ïû•ÌïòÍ≥†, Îπ†Î•∏ ÌîºÎìúÎ∞± Î£®ÌîÑÎ•º Íµ¨Ï∂ïÌïòÎ©∞, ÏïàÏ†ÑÌïú Î∞∞Ìè¨Î•º Ïã§ÌòÑÌïòÎäî Í≤ÉÏù¥ Î™©ÌëúÏûÖÎãàÎã§.

## ÌÖåÏä§Ìä∏ ÏûêÎèôÌôî ÏïÑÌÇ§ÌÖçÏ≤ò

### Ï†ÑÏ≤¥ ÏïÑÌÇ§ÌÖçÏ≤ò Îã§Ïù¥Ïñ¥Í∑∏Îû®

```mermaid
graph TB
    A[Developer Push] --> B[GitHub Actions Trigger]
    B --> C{PR or Main?}
    
    C -->|PR| D[PR Validation Pipeline]
    C -->|Main| E[Main Branch Pipeline]
    
    D --> F[Unit Tests]
    D --> G[Integration Tests]
    D --> H[Component Tests]
    D --> I[Lint & Type Check]
    
    F --> J[Coverage Report]
    G --> J
    H --> J
    
    J --> K{Coverage >= 80%?}
    K -->|No| L[Block PR]
    K -->|Yes| M[E2E Tests Preview]
    M --> N[PR Ready for Review]
    
    E --> O[Full Test Suite]
    O --> P[Performance Tests]
    O --> Q[Security Tests]
    O --> R[E2E Tests Production]
    
    P --> S{All Tests Pass?}
    Q --> S
    R --> S
    
    S -->|No| T[Deployment Blocked]
    S -->|Yes| U[Deploy to Production]
    U --> V[Post-Deploy Monitoring]
```

## CI/CD ÌååÏù¥ÌîÑÎùºÏù∏ Íµ¨ÏÑ±

### GitHub Actions ÏõåÌÅ¨ÌîåÎ°úÏö∞

#### 1. PR Í≤ÄÏ¶ù ÌååÏù¥ÌîÑÎùºÏù∏
```yaml
# .github/workflows/pr-validation.yml
name: PR Validation Pipeline

on:
  pull_request:
    branches: [ main ]
    paths:
      - 'components/coupons/**'
      - 'hooks/use-coupon*'
      - 'convex/coupons.ts'
      - '__tests__/**'

env:
  NODE_VERSION: '20'
  CONVEX_DEPLOYMENT: ${{ secrets.CONVEX_TEST_DEPLOYMENT }}

jobs:
  setup:
    runs-on: ubuntu-latest
    outputs:
      cache-key: ${{ steps.cache-key.outputs.key }}
    steps:
      - uses: actions/checkout@v4
      
      - name: Generate cache key
        id: cache-key
        run: echo "key=${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}" >> $GITHUB_OUTPUT
      
      - uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'
          cache-dependency-path: package-lock.json
      
      - name: Install dependencies
        run: npm ci --frozen-lockfile

  lint-and-types:
    needs: setup
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'
      
      - run: npm ci --frozen-lockfile
      - run: npm run lint
      - run: npm run type-check

  unit-tests:
    needs: setup
    runs-on: ubuntu-latest
    strategy:
      matrix:
        shard: [1, 2, 3] # ÌÖåÏä§Ìä∏ Î∂ÑÏÇ∞ Ïã§Ìñâ
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'
      
      - run: npm ci --frozen-lockfile
      - run: npm run test:unit -- --shard=${{ matrix.shard }}/3 --reporter=json --outputFile=unit-test-results-${{ matrix.shard }}.json
      
      - name: Upload test results
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: unit-test-results-${{ matrix.shard }}
          path: unit-test-results-${{ matrix.shard }}.json

  integration-tests:
    needs: setup
    runs-on: ubuntu-latest
    services:
      # Mock Convex backend for integration tests
      convex-mock:
        image: convex/mock-backend:latest
        ports:
          - 3001:3001
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'
      
      - run: npm ci --frozen-lockfile
      - run: npm run test:integration
        env:
          CONVEX_URL: http://localhost:3001

  component-tests:
    needs: setup
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'
      
      - run: npm ci --frozen-lockfile
      - run: npm run test:components
      
      - name: Generate component test report
        run: npm run test:components -- --reporter=html --outputFile=component-test-report.html
      
      - name: Upload component test report
        uses: actions/upload-artifact@v4
        with:
          name: component-test-report
          path: component-test-report.html

  coverage-report:
    needs: [unit-tests, integration-tests, component-tests]
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'
      
      - run: npm ci --frozen-lockfile
      
      - name: Download unit test results
        uses: actions/download-artifact@v4
        with:
          pattern: unit-test-results-*
          merge-multiple: true
      
      - name: Generate coverage report
        run: |
          npm run test:coverage -- --reporter=json --outputFile=coverage.json
          npm run test:coverage -- --reporter=html --outputDir=coverage-html
      
      - name: Check coverage threshold
        run: |
          COVERAGE=$(node -p "JSON.parse(require('fs').readFileSync('coverage.json', 'utf8')).total.lines.pct")
          if (( $(echo "$COVERAGE < 80" | bc -l) )); then
            echo "Coverage $COVERAGE% is below 80% threshold"
            exit 1
          fi
          echo "Coverage: $COVERAGE%"
      
      - name: Upload coverage to Codecov
        uses: codecov/codecov-action@v4
        with:
          file: ./coverage.json
          flags: coupon-system
          name: coupon-coverage
          fail_ci_if_error: true
      
      - name: Comment PR with coverage
        uses: marocchino/sticky-pull-request-comment@v2
        with:
          header: coverage
          message: |
            ## üìä Coverage Report
            
            | Metric | Coverage | Status |
            |--------|----------|---------|
            | Lines | ${{ env.COVERAGE_LINES }}% | ${{ env.COVERAGE_LINES >= 80 && '‚úÖ' || '‚ùå' }} |
            | Branches | ${{ env.COVERAGE_BRANCHES }}% | ${{ env.COVERAGE_BRANCHES >= 80 && '‚úÖ' || '‚ùå' }} |
            | Functions | ${{ env.COVERAGE_FUNCTIONS }}% | ${{ env.COVERAGE_FUNCTIONS >= 80 && '‚úÖ' || '‚ùå' }} |
            | Statements | ${{ env.COVERAGE_STATEMENTS }}% | ${{ env.COVERAGE_STATEMENTS >= 80 && '‚úÖ' || '‚ùå' }} |

  e2e-preview:
    needs: [lint-and-types, coverage-report]
    runs-on: ubuntu-latest
    if: success()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'
      
      - run: npm ci --frozen-lockfile
      - run: npm run build
      
      # Deploy to preview environment
      - name: Deploy to preview
        id: deploy-preview
        run: |
          # Deploy to Vercel preview or similar
          echo "preview-url=https://pr-${{ github.event.number }}.preview.hooklabs.com" >> $GITHUB_OUTPUT
      
      # Run E2E tests against preview
      - name: Run E2E tests
        run: npm run test:e2e
        env:
          E2E_BASE_URL: ${{ steps.deploy-preview.outputs.preview-url }}
          CI: true
      
      - name: Upload E2E artifacts
        uses: actions/upload-artifact@v4
        if: failure()
        with:
          name: e2e-screenshots
          path: test-results/

  security-scan:
    needs: setup
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Run npm audit
        run: npm audit --audit-level high --production
      
      - name: Run Snyk security scan
        uses: snyk/actions/node@master
        env:
          SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
        with:
          args: --severity-threshold=medium
      
      - name: CodeQL Analysis
        uses: github/codeql-action/analyze@v3
        with:
          languages: typescript, javascript
          queries: security-and-quality

  pr-status:
    needs: [lint-and-types, coverage-report, e2e-preview, security-scan]
    runs-on: ubuntu-latest
    if: always()
    steps:
      - name: PR Status Check
        run: |
          if [[ "${{ needs.lint-and-types.result }}" == "success" && \
                "${{ needs.coverage-report.result }}" == "success" && \
                "${{ needs.e2e-preview.result }}" == "success" && \
                "${{ needs.security-scan.result }}" == "success" ]]; then
            echo "‚úÖ All checks passed - PR ready for review"
            exit 0
          else
            echo "‚ùå Some checks failed"
            exit 1
          fi
```

#### 2. Î©îÏù∏ Î∏åÎûúÏπò ÌååÏù¥ÌîÑÎùºÏù∏
```yaml
# .github/workflows/main-pipeline.yml
name: Main Branch Pipeline

on:
  push:
    branches: [ main ]
  schedule:
    # Îß§Ïùº Î∞§ 2ÏãúÏóê Ï†ÑÏ≤¥ ÌÖåÏä§Ìä∏ Ïã§Ìñâ
    - cron: '0 2 * * *'

jobs:
  full-test-suite:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
        node: [18, 20]
        exclude:
          - os: windows-latest
            node: 18
          - os: macos-latest
            node: 18
    
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: ${{ matrix.node }}
          cache: 'npm'
      
      - run: npm ci --frozen-lockfile
      - run: npm run test:unit
      - run: npm run test:integration
      - run: npm run test:components

  performance-tests:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
      
      - run: npm ci --frozen-lockfile
      - run: npm run build
      
      # Start application for performance testing
      - name: Start application
        run: |
          npm start &
          sleep 30 # Wait for app to start
      
      # Run K6 load tests
      - name: Run performance tests
        run: |
          # Install K6
          curl https://github.com/grafana/k6/releases/download/v0.47.0/k6-v0.47.0-linux-amd64.tar.gz -L | tar xvz
          sudo cp k6-v0.47.0-linux-amd64/k6 /usr/bin
          
          # Run load tests
          k6 run __tests__/performance/coupon-load-testing.js
          
      - name: Upload performance results
        uses: actions/upload-artifact@v4
        with:
          name: performance-results
          path: reports/

  e2e-production:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        browser: [chromium, firefox, webkit]
    
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
      
      - run: npm ci --frozen-lockfile
      
      - name: Install Playwright
        run: npx playwright install ${{ matrix.browser }}
      
      - run: npm run build
      - run: npm start &
      
      - name: Run E2E tests
        run: npm run test:e2e -- --project=${{ matrix.browser }}
      
      - name: Upload test results
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: e2e-results-${{ matrix.browser }}
          path: test-results/

  deploy:
    needs: [full-test-suite, performance-tests, e2e-production]
    runs-on: ubuntu-latest
    if: success() && github.ref == 'refs/heads/main'
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Deploy to production
        run: |
          echo "üöÄ Deploying to production..."
          # Production deployment logic here
      
      - name: Post-deployment health check
        run: |
          sleep 60 # Wait for deployment
          curl -f https://hooklabs.com/api/health || exit 1
      
      - name: Run smoke tests
        run: |
          npm run test:e2e -- --grep="@smoke"
```

### Î°úÏª¨ Í∞úÎ∞ú ÏûêÎèôÌôî

#### Pre-commit Hooks
```bash
# .husky/pre-commit
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "üîç Running pre-commit checks..."

# Run linting
npm run lint || {
  echo "‚ùå Linting failed. Please fix the issues before committing."
  exit 1
}

# Run type checking
npm run type-check || {
  echo "‚ùå Type checking failed. Please fix the issues before committing."
  exit 1
}

# Run unit tests for changed files
CHANGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(ts|tsx)$' | head -10)

if [ ! -z "$CHANGED_FILES" ]; then
  echo "üß™ Running tests for changed files..."
  npm run test:unit -- --changed || {
    echo "‚ùå Tests failed. Please fix the failing tests before committing."
    exit 1
  }
fi

echo "‚úÖ Pre-commit checks passed!"
```

#### Pre-push Hooks
```bash
# .husky/pre-push
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "üöÄ Running pre-push checks..."

# Run full test suite for coupon-related changes
if git diff @{upstream} --name-only | grep -q "coupon"; then
  echo "üé´ Coupon-related changes detected. Running coupon test suite..."
  
  npm run test:unit -- --testPathPattern="coupon" || {
    echo "‚ùå Coupon unit tests failed."
    exit 1
  }
  
  npm run test:integration -- --testPathPattern="coupon" || {
    echo "‚ùå Coupon integration tests failed."
    exit 1
  }
  
  npm run test:components -- --testPathPattern="coupon" || {
    echo "‚ùå Coupon component tests failed."
    exit 1
  }
fi

echo "‚úÖ Pre-push checks passed!"
```

## ÌÖåÏä§Ìä∏ Ïã§Ìñâ ÏµúÏ†ÅÌôî

### Î≥ëÎ†¨ Ïã§Ìñâ ÏÑ§Ï†ï

#### Vitest ÏÑ§Ï†ï
```typescript
// vitest.config.ts
import { defineConfig } from 'vitest/config'
import { resolve } from 'path'

export default defineConfig({
  test: {
    // Î≥ëÎ†¨ Ïã§Ìñâ ÏÑ§Ï†ï
    threads: true,
    minThreads: 2,
    maxThreads: 4,
    
    // ÌÖåÏä§Ìä∏ ÏÉ§Îî©
    shard: process.env.CI ? {
      index: parseInt(process.env.VITEST_SHARD_INDEX || '1'),
      count: parseInt(process.env.VITEST_SHARD_COUNT || '3')
    } : undefined,
    
    // Ï∫êÏãú ÏµúÏ†ÅÌôî
    cache: {
      dir: '.vitest/cache'
    },
    
    // Î©îÎ™®Î¶¨ ÏµúÏ†ÅÌôî
    pool: 'threads',
    poolOptions: {
      threads: {
        minThreads: 2,
        maxThreads: 4
      }
    },
    
    // ÌÖåÏä§Ìä∏ ÌååÏùº Ìå®ÌÑ¥ ÏµúÏ†ÅÌôî
    include: [
      '__tests__/**/*.{test,spec}.{ts,tsx}',
      '**/*.{test,spec}.{ts,tsx}'
    ],
    
    // Îπ†Î•∏ Ïã§Ìå® ÏÑ§Ï†ï
    bail: process.env.CI ? 5 : 0,
    
    // ÌÉÄÏûÑÏïÑÏõÉ ÏÑ§Ï†ï
    testTimeout: 30000,
    hookTimeout: 30000,
    
    // Î¶¨Ìè¨ÌåÖ ÏµúÏ†ÅÌôî
    reporter: process.env.CI ? ['json', 'github-actions'] : ['verbose'],
    
    // Ïª§Î≤ÑÎ¶¨ÏßÄ ÏµúÏ†ÅÌôî
    coverage: {
      provider: 'v8',
      reporter: process.env.CI 
        ? ['json-summary', 'json'] 
        : ['text', 'html', 'json-summary'],
      
      // Î≥ëÎ†¨ Ïª§Î≤ÑÎ¶¨ÏßÄ ÏàòÏßë
      all: true,
      
      // Ï†úÏô∏ Ìå®ÌÑ¥ ÏµúÏ†ÅÌôî
      exclude: [
        'node_modules/**',
        '.next/**',
        'convex/_generated/**',
        '**/*.d.ts',
        '**/__mocks__/**',
        '**/__tests__/**',
        '**/test-utils/**'
      ],
      
      // ÏûÑÍ≥ÑÍ∞í ÏÑ§Ï†ï
      thresholds: {
        global: {
          branches: 80,
          functions: 80,
          lines: 80,
          statements: 80
        },
        
        // ÌååÏùºÎ≥Ñ ÏûÑÍ≥ÑÍ∞í
        perFile: true,
        
        // Ïø†Ìè∞ Í¥ÄÎ†® ÌååÏùº Îçî ÎÜíÏùÄ ÏûÑÍ≥ÑÍ∞í
        'components/coupons/**/*.{ts,tsx}': {
          branches: 85,
          functions: 90,
          lines: 85,
          statements: 85
        }
      }
    }
  }
})
```

#### Playwright ÏÑ§Ï†ï
```typescript
// playwright.config.ts
import { defineConfig, devices } from '@playwright/test'

export default defineConfig({
  testDir: '__tests__/e2e',
  
  // Î≥ëÎ†¨ Ïã§Ìñâ
  workers: process.env.CI ? 2 : undefined,
  
  // Ïû¨ÏãúÎèÑ ÏÑ§Ï†ï
  retries: process.env.CI ? 2 : 0,
  
  // ÌÉÄÏûÑÏïÑÏõÉ
  timeout: 30 * 1000,
  expect: { timeout: 5 * 1000 },
  
  // Ï†ÑÏó≠ ÏÑ§Ï†ï
  use: {
    baseURL: process.env.E2E_BASE_URL || 'http://localhost:3000',
    trace: 'on-first-retry',
    screenshot: 'only-on-failure',
    video: 'retain-on-failure'
  },
  
  // Î∏åÎùºÏö∞Ï†Ä ÏÑ§Ï†ï
  projects: [
    {
      name: 'chromium',
      use: { ...devices['Desktop Chrome'] }
    },
    
    {
      name: 'firefox',
      use: { ...devices['Desktop Firefox'] }
    },
    
    {
      name: 'webkit',
      use: { ...devices['Desktop Safari'] }
    },
    
    // Î™®Î∞îÏùº ÌÖåÏä§Ìä∏
    {
      name: 'Mobile Chrome',
      use: { ...devices['Pixel 5'] }
    },
    
    {
      name: 'Mobile Safari',
      use: { ...devices['iPhone 12'] }
    }
  ],
  
  // Î¶¨Ìè¨ÌåÖ
  reporter: process.env.CI 
    ? [['github'], ['json', { outputFile: 'test-results/e2e-results.json' }]]
    : [['html'], ['list']]
})
```

## ÌÖåÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞ Í¥ÄÎ¶¨ ÏûêÎèôÌôî

### ÌÖåÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞ Ìå©ÌÜ†Î¶¨
```typescript
// __tests__/factories/coupon-factory.ts
import { faker } from '@faker-js/faker'
import type { Coupon, CouponType } from '@/types/coupon'

export class CouponFactory {
  static create(overrides?: Partial<Coupon>): Coupon {
    const type: CouponType = faker.helpers.arrayElement(['percentage', 'fixed_amount', 'credits'])
    
    return {
      _id: faker.database.mongodbObjectId(),
      code: faker.string.alphanumeric({ length: 8, casing: 'upper' }),
      name: faker.commerce.productName(),
      description: faker.commerce.productDescription(),
      type,
      value: type === 'percentage' ? faker.number.int({ min: 5, max: 50 }) : faker.number.int({ min: 500, max: 5000 }),
      currency: 'USD',
      minAmount: faker.number.int({ min: 1000, max: 5000 }),
      maxDiscount: type === 'percentage' ? faker.number.int({ min: 1000, max: 10000 }) : undefined,
      usageLimit: faker.number.int({ min: 100, max: 1000 }),
      usageCount: faker.number.int({ min: 0, max: 50 }),
      userLimit: faker.number.int({ min: 1, max: 3 }),
      validFrom: faker.date.past().toISOString(),
      validUntil: faker.date.future().toISOString(),
      isActive: faker.datatype.boolean(0.8), // 80% ÌôúÏÑ±
      createdAt: faker.date.past().toISOString(),
      updatedAt: faker.date.recent().toISOString(),
      ...overrides
    }
  }
  
  static createMany(count: number, overrides?: Partial<Coupon>): Coupon[] {
    return Array.from({ length: count }, () => this.create(overrides))
  }
  
  static createExpired(overrides?: Partial<Coupon>): Coupon {
    return this.create({
      validUntil: faker.date.past().toISOString(),
      ...overrides
    })
  }
  
  static createOverused(overrides?: Partial<Coupon>): Coupon {
    const usageLimit = faker.number.int({ min: 10, max: 50 })
    return this.create({
      usageLimit,
      usageCount: usageLimit,
      ...overrides
    })
  }
  
  static createForScenario(scenario: 'valid' | 'expired' | 'overused' | 'inactive'): Coupon {
    switch (scenario) {
      case 'expired':
        return this.createExpired()
      case 'overused':
        return this.createOverused()
      case 'inactive':
        return this.create({ isActive: false })
      default:
        return this.create({ isActive: true })
    }
  }
}
```

### Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÏãúÎî© ÏûêÎèôÌôî
```typescript
// __tests__/setup/database-seeder.ts
import { CouponFactory } from '../factories/coupon-factory'

export class DatabaseSeeder {
  static async seedCoupons(convexClient: any, count: number = 10) {
    const coupons = CouponFactory.createMany(count)
    
    for (const coupon of coupons) {
      await convexClient.mutation('api.coupons.create', coupon)
    }
    
    return coupons
  }
  
  static async seedScenarios(convexClient: any) {
    const scenarios = [
      CouponFactory.createForScenario('valid'),
      CouponFactory.createForScenario('expired'), 
      CouponFactory.createForScenario('overused'),
      CouponFactory.createForScenario('inactive')
    ]
    
    for (const coupon of scenarios) {
      await convexClient.mutation('api.coupons.create', coupon)
    }
    
    return scenarios
  }
  
  static async cleanup(convexClient: any) {
    // ÌÖåÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞ Ï†ïÎ¶¨
    const allCoupons = await convexClient.query('api.coupons.getAll')
    
    for (const coupon of allCoupons) {
      if (coupon.description?.includes('Generated during load test') || 
          coupon.name?.includes('Test')) {
        await convexClient.mutation('api.coupons.delete', { id: coupon._id })
      }
    }
  }
}
```

## Î™®ÎãàÌÑ∞ÎßÅ Î∞è ÏïåÎ¶º

### ÌÖåÏä§Ìä∏ Í≤∞Í≥º Î™®ÎãàÌÑ∞ÎßÅ
```typescript
// scripts/test-monitor.ts
import { WebClient } from '@slack/web-api'
import { readFileSync } from 'fs'

interface TestResults {
  total: number
  passed: number
  failed: number
  skipped: number
  duration: number
  coverage: {
    lines: number
    branches: number
    functions: number
    statements: number
  }
}

export class TestMonitor {
  private slack: WebClient
  
  constructor(slackToken: string) {
    this.slack = new WebClient(slackToken)
  }
  
  async notifyTestResults(results: TestResults, channel: string) {
    const status = results.failed === 0 ? 'success' : 'failure'
    const emoji = status === 'success' ? '‚úÖ' : '‚ùå'
    
    const message = {
      channel,
      text: `${emoji} Test Results`,
      blocks: [
        {
          type: 'header',
          text: {
            type: 'plain_text',
            text: `${emoji} Coupon System Test Results`
          }
        },
        {
          type: 'section',
          fields: [
            {
              type: 'mrkdwn',
              text: `*Total Tests:* ${results.total}`
            },
            {
              type: 'mrkdwn', 
              text: `*Passed:* ${results.passed}`
            },
            {
              type: 'mrkdwn',
              text: `*Failed:* ${results.failed}`
            },
            {
              type: 'mrkdwn',
              text: `*Duration:* ${(results.duration / 1000).toFixed(1)}s`
            }
          ]
        },
        {
          type: 'section',
          text: {
            type: 'mrkdwn',
            text: `*Coverage:* Lines ${results.coverage.lines}% | Branches ${results.coverage.branches}% | Functions ${results.coverage.functions}%`
          }
        }
      ]
    }
    
    if (results.failed > 0) {
      message.blocks.push({
        type: 'section',
        text: {
          type: 'mrkdwn',
          text: `‚ö†Ô∏è *${results.failed} tests failed.* Please check the CI logs for details.`
        }
      })
    }
    
    await this.slack.chat.postMessage(message)
  }
  
  async notifyPerformanceRegression(baselineMs: number, currentMs: number, threshold: number) {
    const regression = ((currentMs - baselineMs) / baselineMs) * 100
    
    if (regression > threshold) {
      await this.slack.chat.postMessage({
        channel: '#dev-alerts',
        text: 'üêå Performance Regression Detected',
        blocks: [
          {
            type: 'section',
            text: {
              type: 'mrkdwn',
              text: `‚ö†Ô∏è *Performance regression detected in coupon system*\n\n*Baseline:* ${baselineMs}ms\n*Current:* ${currentMs}ms\n*Regression:* +${regression.toFixed(1)}%`
            }
          }
        ]
      })
    }
  }
}
```

### ÎåÄÏãúÎ≥¥Îìú ÏÑ§Ï†ï
```typescript
// scripts/create-test-dashboard.ts
import { writeFileSync } from 'fs'

export function generateTestDashboard(results: any[]) {
  const html = `
<!DOCTYPE html>
<html>
<head>
  <title>Coupon System Test Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .card { background: #f5f5f5; padding: 20px; margin: 10px 0; border-radius: 8px; }
    .metrics { display: flex; gap: 20px; }
    .metric { text-align: center; }
    .metric h3 { margin: 0; font-size: 2em; }
    .success { color: #28a745; }
    .warning { color: #ffc107; }
    .danger { color: #dc3545; }
  </style>
</head>
<body>
  <h1>üé´ Coupon System Test Dashboard</h1>
  
  <div class="card">
    <h2>Current Status</h2>
    <div class="metrics">
      <div class="metric">
        <h3 class="success">${results.length}</h3>
        <p>Total Test Runs</p>
      </div>
      <div class="metric">
        <h3 class="success">${results.filter(r => r.status === 'passed').length}</h3>
        <p>Successful Runs</p>
      </div>
      <div class="metric">
        <h3 class="${results.some(r => r.status === 'failed') ? 'danger' : 'success'}">
          ${results.filter(r => r.status === 'failed').length}
        </h3>
        <p>Failed Runs</p>
      </div>
      <div class="metric">
        <h3>${Math.round(results.reduce((acc, r) => acc + r.coverage, 0) / results.length)}%</h3>
        <p>Avg Coverage</p>
      </div>
    </div>
  </div>
  
  <div class="card">
    <h2>Coverage Trend</h2>
    <canvas id="coverageChart" width="400" height="200"></canvas>
  </div>
  
  <div class="card">
    <h2>Performance Trend</h2>
    <canvas id="performanceChart" width="400" height="200"></canvas>
  </div>
  
  <script>
    // Coverage trend chart
    new Chart(document.getElementById('coverageChart'), {
      type: 'line',
      data: {
        labels: ${JSON.stringify(results.map(r => new Date(r.timestamp).toLocaleDateString()))},
        datasets: [{
          label: 'Coverage %',
          data: ${JSON.stringify(results.map(r => r.coverage))},
          borderColor: '#28a745',
          tension: 0.1
        }]
      },
      options: {
        scales: {
          y: {
            beginAtZero: true,
            max: 100
          }
        }
      }
    });
    
    // Performance trend chart
    new Chart(document.getElementById('performanceChart'), {
      type: 'line',
      data: {
        labels: ${JSON.stringify(results.map(r => new Date(r.timestamp).toLocaleDateString()))},
        datasets: [{
          label: 'Duration (ms)',
          data: ${JSON.stringify(results.map(r => r.duration))},
          borderColor: '#007bff',
          tension: 0.1
        }]
      }
    });
  </script>
</body>
</html>
  `
  
  writeFileSync('test-dashboard.html', html)
  console.log('üìä Test dashboard generated: test-dashboard.html')
}
```

## ÌÖåÏä§Ìä∏ ÏûêÎèôÌôî Î≤†Ïä§Ìä∏ ÌîÑÎûôÌã∞Ïä§

### 1. Îπ†Î•∏ ÌîºÎìúÎ∞± Î£®ÌîÑ
- Î≥ÄÍ≤ΩÎêú ÌååÏùºÍ≥º Í¥ÄÎ†®Îêú ÌÖåÏä§Ìä∏Îßå Ïã§Ìñâ
- Î≥ëÎ†¨ Ïã§ÌñâÏúºÎ°ú Ï¥ù Ïã§Ìñâ ÏãúÍ∞Ñ Îã®Ï∂ï
- Ï∫êÏã±ÏùÑ ÌôúÏö©Ìïú Ï§ëÎ≥µ ÏûëÏóÖ Ï†úÍ±∞

### 2. ÏïàÏ†ïÏ†ÅÏù∏ ÌÖåÏä§Ìä∏
- ÌôòÍ≤Ω ÎèÖÎ¶ΩÏ†ÅÏù∏ ÌÖåÏä§Ìä∏ ÏûëÏÑ±
- ÌÖåÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞ Í≤©Î¶¨ Î∞è Ï†ïÎ¶¨
- Ï†ÅÏ†àÌïú ÌÉÄÏûÑÏïÑÏõÉ Î∞è Ïû¨ÏãúÎèÑ ÏÑ§Ï†ï

### 3. Ïú†ÏßÄÎ≥¥Ïàò Í∞ÄÎä•Ìïú ÏûêÎèôÌôî
- Î™ÖÌôïÌïú ÏóêÎü¨ Î©îÏãúÏßÄÏôÄ ÎîîÎ≤ÑÍπÖ Ï†ïÎ≥¥
- ÌÖåÏä§Ìä∏ ÏΩîÎìúÏùò ÌíàÏßà Í¥ÄÎ¶¨
- Î¨∏ÏÑúÌôîÎêú ÏÑ§Ï†ïÍ≥º ÌîÑÎ°úÏÑ∏Ïä§

### 4. Ìö®Í≥ºÏ†ÅÏù∏ Î™®ÎãàÌÑ∞ÎßÅ
- ÌïµÏã¨ Î©îÌä∏Î¶≠ Ï∂îÏ†Å
- ÏûÑÍ≥ÑÍ∞í Í∏∞Î∞ò ÏïåÎ¶º
- Ìä∏Î†åÎìú Î∂ÑÏÑù Î∞è ÏÑ±Îä• ÌöåÍ∑Ä Í∞êÏßÄ

## Í≤∞Î°†

Ïù¥ ÌÖåÏä§Ìä∏ ÏûêÎèôÌôî ÏãúÏä§ÌÖúÏùÑ ÌÜµÌï¥ Ïö∞Î¶¨Îäî Îã§ÏùåÏùÑ Îã¨ÏÑ±Ìï† Ïàò ÏûàÏäµÎãàÎã§:

1. **Îπ†Î•∏ ÌîºÎìúÎ∞±**: ÏΩîÎìú Î≥ÄÍ≤Ω ÌõÑ 5Î∂Ñ Ïù¥ÎÇ¥ Í≤∞Í≥º ÌôïÏù∏
2. **ÎÜíÏùÄ Ïã†Î¢∞ÏÑ±**: 99% Ïù¥ÏÉÅÏùò ÌÖåÏä§Ìä∏ ÏïàÏ†ïÏÑ±
3. **ÏôÑÏ†Ñ ÏûêÎèôÌôî**: ÏàòÎèô Í∞úÏûÖ ÏóÜÎäî ÌÖåÏä§Ìä∏ Ïã§Ìñâ
4. **Ìè¨Í¥ÑÏ†Å Î™®ÎãàÌÑ∞ÎßÅ**: Ïã§ÏãúÍ∞Ñ ÏÉÅÌÉú Ï∂îÏ†Å Î∞è ÏïåÎ¶º

ÏßÄÏÜçÏ†ÅÏù∏ Í∞úÏÑ†ÏùÑ ÌÜµÌï¥ ÎçîÏö± Ìö®Ïú®Ï†ÅÏù¥Í≥† ÏïàÏ†ïÏ†ÅÏù∏ ÌÖåÏä§Ìä∏ ÏûêÎèôÌôîÎ•º Íµ¨Ï∂ïÌï¥ ÎÇòÍ∞ÄÍ≤†ÏäµÎãàÎã§.

---

**Î¨∏ÏÑú ÏûëÏÑ±Ïùº**: 2025ÎÖÑ 9Ïõî 3Ïùº  
**ÎßàÏßÄÎßâ ÏóÖÎç∞Ïù¥Ìä∏**: 2025ÎÖÑ 9Ïõî 3Ïùº  
**Îã¥ÎãπÏûê**: Testing Specialist  
**Í¥ÄÎ†® ÎèÑÍµ¨**: GitHub Actions, Vitest, Playwright, K6, Slack